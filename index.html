<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tomasz Łachut - portfolio</title>
</head>
<body>
    <p>
        BAZA LOTY 

1 Wyświetl pasażerów z Wałbrzycha 

SELECT * FROM `pasazerowie` WHERE `miejscowosc` = "Walbrzych"; 

 

2 Wyświetl pasażerów z Jawora 

SELECT * FROM `pasazerowie` WHERE `miejscowosc` = "Jawor"; 

 

 

3 Wyświetl ilość pasażerów z każdej miejscowości /nazwa miejscowosci, ilość/ 

SELECT `miejscowosc`, COUNT(`id_pasazera`) AS IloscPasazerow FROM `pasazerowie` GROUP BY `miejscowosc`; 

 

4 Wyświetl ile razy imię występuje w bazie 

SELECT `imie`, COUNT(`id_pasazera`) AS IloscImieniaWBazie FROM `pasazerowie` GROUP BY `imie`; 

 

 

5 Wyświetl osoby o imieniu Agnieszka 

SELECT * FROM `pasazerowie` WHERE `imie` = "Agnieszka"; 

 

6 Wyświetl osoby o imieniu rozpoczynającym się literką A 

SELECT * FROM `pasazerowie` WHERE `imie` LIKE "A%"; 

 

 

7 Wyświetl osoby z numerem telefonu zaczynającym się 2 

SELECT * FROM `pasazerowie` WHERE `tel` LIKE "2%"; 

 

8 Wyświetl 2 najpopularniejsze imiona pasażerów na literkę m 

SELECT `imie`, COUNT(`id_pasazera`) AS IloscImieniaWBazie FROM `pasazerowie` WHERE `imie` LIKE "M%" GROUP BY `imie` ORDER BY IloscImieniaWBazie DESC LIMIT 2; 

 

 

9 Ile lotów odbyło się do każdej z miejscowości /spis alfabetyczny/ 

SELECT `miejsce_docelowe`, COUNT(`id_lotu`) AS IloscLotow FROM `loty` GROUP BY `miejsce_docelowe` ORDER BY `miejsce_docelowe`; 

 

10 Który pasażer odbył najwiecej lotów i ile 

SELECT pasazerowie.id_pasazera, pasazerowie.nazwisko, pasazerowie.imie, COUNT(loty.id_lotu) AS IloscLotow FROM bilety, loty, pasazerowie WHERE pasazerowie.id_pasazera = bilety.id_pasazera AND loty.id_lotu = bilety.id_lotu GROUP BY pasazerowie.id_pasazera ORDER BY IloscLotow DESC LIMIT 1; 

 

 

11 wyświetl loty pasażera o numerze 283 

SELECT loty.id_lotu, loty.miejsce_docelowe, loty.data, loty.godzina FROM loty, bilety, pasazerowie WHERE pasazerowie.id_pasazera = 283 AND bilety.id_lotu = loty.id_lotu AND bilety.id_pasazera = pasazerowie.id_pasazera; 

 

12 Wyświetl nazwisko, imię i numer pasażera któy odbył najwięcej lotów 

SELECT pasazerowie.nazwisko, pasazerowie.imie, pasazerowie.id_pasazera FROM bilety, loty, pasazerowie WHERE pasazerowie.id_pasazera = bilety.id_pasazera AND loty.id_lotu = bilety.id_lotu GROUP BY pasazerowie.id_pasazera ORDER BY COUNT(loty.id_lotu) DESC LIMIT 1; 

 

13 Kto najczęściej latał do Barcelony (ile razy) 

SELECT pasazerowie.id_pasazera, pasazerowie.nazwisko, pasazerowie.imie, COUNT(loty.id_lotu) AS IloscLotow FROM bilety, loty, pasazerowie WHERE loty.miejsce_docelowe = "Barcelona" AND pasazerowie.id_pasazera = bilety.id_pasazera AND loty.id_lotu = bilety.id_lotu GROUP BY pasazerowie.id_pasazera ORDER BY IloscLotow DESC LIMIT 1; 

 

14 Gdzie najczęściej latali mieszkańcy Wroclawia 

SELECT loty.miejsce_docelowe FROM loty, bilety, pasazerowie WHERE pasazerowie.miejscowosc = "Wroclaw" AND bilety.id_pasazera = pasazerowie.id_pasazera AND bilety.id_lotu = loty.id_lotu GROUP BY loty.miejsce_docelowe ORDER BY COUNT(loty.id_lotu) DESC LIMIT 1; 

 

15 Wyświetl wykaz lotów pasażerów z Wrocławia do Glasgow /nr.pasażera, nr.lotu/ 

SELECT pasazerowie.id_pasazera, loty.id_lotu FROM pasazerowie, loty, bilety WHERE pasazerowie.miejscowosc = "Wroclaw" AND loty.miejsce_docelowe = "Glasgow" AND bilety.id_lotu = loty.id_lotu AND bilety.id_pasazera = pasazerowie.id_pasazera; 

 

16 Którym lotem leciało najwięcej pasażerów (ilu) 

SELECT loty.id_lotu, COUNT(bilety.id_pasazera) AS IloscPasazerow FROM bilety, loty WHERE bilety.id_lotu = loty.id_lotu GROUP BY loty.id_lotu ORDER BY IloscPasazerow DESC LIMIT 1; 

 

17 W którym dniu odbyło się najmniej lotów? Ile? 

SELECT loty.data, COUNT(loty.id_lotu) AS IloscLotow FROM loty GROUP BY loty.data ORDER BY IloscLotow ASC LIMIT 1; 

 

18 W jakim dniu i do jakiej miejscowości odbyło się najwiecej lotów 

SELECT loty.data, loty.miejsce_docelowe, COUNT(loty.id_lotu) AS IloscLotow FROM loty GROUP BY loty.data, loty.miejsce_docelowe ORDER BY IloscLotow DESC LIMIT 1; 

 

19* Wyświetl dni i miejscowości do których odbyło się więcej niż jeden lot dziennie 

SELECT loty.data, loty.miejsce_docelowe, COUNT(loty.id_lotu) AS IloscLotow FROM loty GROUP BY loty.data, loty.miejsce_docelowe HAVING COUNT(loty.id_lotu) > 1; 

 
    </p>
</body>
</html>
